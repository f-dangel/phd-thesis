
\begin{figure}[!b]
  \centering

  % pgfplots style "gradientsnrdefault"
  \pgfkeys{/pgfplots/gradientsnrdefault/.style={
      width=1.1\linewidth,
      height=0.18\textheight,
      every axis plot/.append style={line width = 1.2pt},
      every axis plot post/.append style={
        mark size=1, mark options={opacity=0.3}
      },
      tick pos = left,
      xmajorticks = true,
      ymajorticks = true,
      ylabel near ticks,
      xlabel near ticks,
      xtick align = inside,
      ytick align = inside,
      legend cell align = left,
      legend columns = 1,
      legend pos = north west,
      legend style = {
        fill opacity = 0.9,
        text opacity = 1,
        font = \small,
      },
      xticklabel style = {font = \small, inner xsep = -5ex},
      xlabel style = {font = \small},
      axis line style = {black},
      yticklabel style = {font = \small, inner ysep = -4ex},
      ylabel style = {font = \small, inner ysep = -4ex},
      title style = {font = \small, inner ysep = -3ex},
      grid = major,
      grid style = {dashed}
    }
  }

  % pgfplots style for first few rows "gradientsnrdefaultfirst"
  \pgfkeys{/pgfplots/gradientsnrdefaultfirst/.style={
      gradientsnrdefault,
      xlabel=\empty,
      xticklabels=\empty,
      title=\empty,
  }}

  % pgfplots style for first last row "gradientsnrdefaultfirst"
  \pgfkeys{/pgfplots/gradientsnrdefaultlast/.style={
      gradientsnrdefault,
      title=\empty,
    }}

  \pgfkeys{/pgfplots/overwritecolor0/.style={
      % overwrite color0 with orange
      execute at begin picture={\definecolor{color0}{rgb}{1,0.498039215686275,0.0549019607843137}},
      }}

  \begin{flushleft}
    \vspace{1ex}
    (a)
  \end{flushleft}
  \vspace{-2\baselineskip}

  \hfill
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultfirst,
        title = {GSNR, same batch},
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_0/gradient_snr_000000.tex}
  \end{minipage}
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultfirst, overwritecolor0,
        title = {GSNR, different batches},
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_1/gradient_snr_000000.tex}
  \end{minipage}
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultfirst, overwritecolor0,
        title = {GSNR, different batches},
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_2/gradient_snr_000000.tex}
  \end{minipage}
  \hfill

  \vspace{-2\baselineskip}

  \begin{flushleft}
    \vspace{1ex}
    (b)
  \end{flushleft}
  \vspace{-2\baselineskip}

  \hfill
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultfirst,
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_0/gradient_snr_000010.tex}
  \end{minipage}
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultfirst, overwritecolor0,
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_1/gradient_snr_000010.tex}
  \end{minipage}
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultfirst, overwritecolor0,
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_2/gradient_snr_000010.tex}
  \end{minipage}
  \hfill

  \vspace{-2\baselineskip}

  \begin{flushleft}
    \vspace{1ex}
    (c)
  \end{flushleft}
  \vspace{-2\baselineskip}

  \hfill
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultlast,
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_0/gradient_snr_000200.tex}
  \end{minipage}
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultlast, overwritecolor0,
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_1/gradient_snr_000200.tex}
  \end{minipage}
  \begin{minipage}[t]{0.325\linewidth}
    \centering
    % customize "zmystyle" as you wish
    \pgfkeys{/pgfplots/zmystyle/.style={gradientsnrdefaultlast, overwritecolor0,
      }}
    \input{../../fig/exp04_gradient_signal_to_noise_ratio/fig/GGN_0_grad_2/gradient_snr_000200.tex}
  \end{minipage}
  \hfill

  \vspace{-1\baselineskip}

  \caption{\textbf{Gradient signal-to-noise ratio along \ggn directions:} All
    plots show pairs $(\lambda_i, r_i)$. Tuple notation denotes batch identity,
    that is $(0,1)$ indicates gradient signal-to-noise ratio of \ggn on batch 0
    and gradient on batch 1. The horizontal line marks $r=0.1$. The net (a
    simple, but deep convolutional neural net on \mnist) is trained with \sgd
    ($N=128$). Rows show the distributions at \textbf{(a)} initialization,
    \textbf{(b)} early phase (step 10), and \textbf{(c)} end of training (step
    200).}
  \label{fig:gradient-signal-to-noise-ratio}
\end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
