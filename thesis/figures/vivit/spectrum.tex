\begin{figure*}[p]
  \centering

  \begin{minipage}[t]{0.495\linewidth}
    \centering
    \begin{footnotesize}
      \textbf{Full network}
    \end{footnotesize}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.495\linewidth}
    \centering
    \begin{footnotesize}
      \textbf{Block-diagonal approximation}
    \end{footnotesize}
  \end{minipage}

  \begin{subfigure}[t]{\linewidth}
    \centering
    \caption{\fmnist \twoctwod}
    \begin{minipage}[t]{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/fmnist_2c2d_cpu_one_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/fmnist_2c2d_cpu_one_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/fmnist_2c2d_cpu_one_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
    \hfill
    \begin{minipage}[t]{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 5e-4,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/fmnist_2c2d_cpu_layerwise_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 5e-4,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/fmnist_2c2d_cpu_layerwise_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 5e-4,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/fmnist_2c2d_cpu_layerwise_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
  \end{subfigure}

  \begin{subfigure}{\linewidth}
    \centering
    \caption{\cifarten \threecthreed}
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_3c3d_cpu_one_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_3c3d_cpu_one_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_3c3d_cpu_one_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
    \hfill
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 3e-3,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_3c3d_cpu_layerwise_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 3e-3,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_3c3d_cpu_layerwise_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 3e-3,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_3c3d_cpu_layerwise_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
  \end{subfigure}

  \begin{subfigure}[t]{\linewidth}
    \centering
    \caption{\cifarten \resnetthirtytwo}
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 1e-4,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet32_cpu_one_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 1e-4,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet32_cpu_one_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 1e-4,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet32_cpu_one_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 3e-3,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet32_cpu_layerwise_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 3e-3,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet32_cpu_layerwise_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 3e-3,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet32_cpu_layerwise_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
  \end{subfigure}
  \caption{\textbf{\ggn spectra of different architectures under \vivittitle's
      approximations:} Left and right columns contain results with the full
    network's \ggn and a per-layer block-diagonal approximation,
    respectively.} \label{vivit::fig:spectrum_1}
\end{figure*}

\addtocounter{figure}{-1}

\begin{figure*}[!t]
  \centering
  \begin{minipage}[t]{0.495\linewidth}
    \centering
    \begin{footnotesize}
      \textbf{Full network}
    \end{footnotesize}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.495\linewidth}
    \centering
    \begin{footnotesize}
      \textbf{Block-diagonal approximation}
    \end{footnotesize}
  \end{minipage}

  \begin{subfigure}[t]{\linewidth}
    \addtocounter{subfigure}{3}
    \caption{\cifarten \resnetfiftysix}
    \centering
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 1e-4,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet56_cpu_one_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 1e-4,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet56_cpu_one_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 1e-4,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet56_cpu_one_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
    \hfill
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 3e-3,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet56_cpu_layerwise_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 3e-3,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet56_cpu_layerwise_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 3e-3,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar10_resnet56_cpu_layerwise_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
  \end{subfigure}

  \begin{subfigure}[t]{\linewidth}
    \centering
    \caption{\cifarhun \allcnnc}
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 1e-3,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar100_allcnnc_cpu_one_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 1e-3,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar100_allcnnc_cpu_one_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 1e-3,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar100_allcnnc_cpu_one_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
    \hfill
    \begin{minipage}{0.495\linewidth}
      \centering
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultleft, ymax = 5e-3,
            title={exact, mb}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar100_allcnnc_cpu_layerwise_group_full_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{1.9ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultcenter, ymax = 5e-3,
            title={exact, sub}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar100_allcnnc_cpu_layerwise_group_frac_batch_exact}
        \tikzexternaldisable
      \end{minipage}
      \hspace{-3.5ex}
      \begin{minipage}[t]{0.33\linewidth}
        \centering
        % load "spectrumdefault{left, center, right}" styles
        \input{figures/vivit/spectrum_default_style}
        % customize "zmystyle" as you wish
        \pgfkeys{/pgfplots/zmystyle/.style={spectrumdefaultright, ymax = 5e-3,
            title={mc, full}}}
        \tikzexternalenable
        \input{../repos/vivit-paper/fig/exp10_performance_ggn_evals/fig/evals/cifar100_allcnnc_cpu_layerwise_group_full_batch_mc}
        \tikzexternaldisable
      \end{minipage}
    \end{minipage}
  \end{subfigure}
  \caption{\textbf{\ggn spectra of different architectures under \vivittitle's
      approximations:} Left and right columns contain results with the full
    network's \ggn and a per-layer block-diagonal approximation,
    respectively.} \label{vivit::fig:spectrum_2}
\end{figure*}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../thesis"
%%% End:
